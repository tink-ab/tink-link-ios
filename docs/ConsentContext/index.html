<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TinkLink - ConsentContext</title>
    <link rel="stylesheet" type="text/css" href="https://tink-ab.github.io/tink-link-ios/all.css" media="all" />
</head>
<body>
    <header>
        <a href="https://tink-ab.github.io/tink-link-ios/">
            <strong>
                TinkLink
            </strong>
            <span>Documentation</span>
        </a>
        <sup>Beta</sup>
    </header>

    <!--
    <form class="search">
        <input type="search" placeholder="Search" />
    </form>
    -->

    <nav>
        <div class="wrapper">
            <h2>On This Page</h2>
            <ol><li><a href="#relationships">Relationships</a><ul><li><a href="#relationships">Nested Types</a></li></ul></li><li><a href="#initializers">Initializers</a><ul><li class="initializer"><a href="#consentcontext.init(tink:)">init(tink:​)</a></li></ul></li><li><a href="#methods">Methods</a><ul><li class="function"><a href="#consentcontext.fetchscopedescriptions(scopes:completion:)">fetch​Scope​Descriptions(scopes:​completion:​)</a></li><li class="function"><a href="#consentcontext.termsandconditions(for:)">terms​And​Conditions(for:​)</a></li><li class="function"><a href="#consentcontext.privacypolicy(for:)">privacy​Policy(for:​)</a></li></ul></li></ol>
        </div>
    </nav>

    <main>
        <article>
            <h1>
    <small>Class</small>
    <code class="name">Consent​Context</code>
</h1>

<html><body><pre class="highlight"><code><span class="keyword">public</span> <span class="attribute">final</span> <span class="keyword">class</span> <span class="type">ConsentContext</span></code></pre></body></html>
<div class="summary" role="doc-abstract">
    <p>An object that you use to get user consent.</p>

</div>
<section id="relationships">
    <h2 hidden>Relationships</h2>
        
        <h3>Nested Types</h3>
<dl>
    <dt class="enumeration"><code><a href="https://tink-ab.github.io/tink-link-ios/ConsentContext_Error">ConsentContext.Error</a></code></dt>
<dd><p>Error that the <code>ConsentContext</code> can throw.</p>
</dd>
</dl>
</section>
    <section id="initializers">
        <h2>Initializers</h2>

        <div role="article" class="initializer" id="consentcontext.init(tink:)">
    <h3>
        <code>init(tink:​)</code>
    </h3>
    <html><body><pre class="highlight"><code><span class="keyword">public</span> <span class="keyword">init</span>(<span class="variable">tink</span>: <a href="https://tink-ab.github.io/tink-link-ios/Tink"><span class="type">Tink</span></a> = .<span class="variable">shared</span>)</code></pre></body></html>
<div class="summary" role="doc-abstract">
    <p>Creates a context to authorize for an authorization code for a user with requested scopes.</p>

</div>
<h4>Parameters</h4>

<table class="parameters">
  <thead hidden>
  <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
  </tr>
  </thead>
  <tbody>
    <tr>
    <th>tink</th>
    <td><code class="type">Tink</code></td>
    <td><p>Tink instance, will use the shared instance if nothing is provided.</p>
</td>
</tr>
  </tbody>
</table>
</div>
    </section>
    <section id="methods">
        <h2>Methods</h2>

        <div role="article" class="function" id="consentcontext.fetchscopedescriptions(scopes:completion:)">
    <h3>
        <code>fetch​Scope​Descriptions(scopes:​completion:​)</code>
    </h3>
    <html><body><pre class="highlight"><code><span class="attribute">@</span><span class="attribute">discardableResult</span> <span class="keyword">public</span> <span class="keyword">func</span> <span class="function">fetchScopeDescriptions</span>(<span class="variable">scopes</span>: [<a href="https://tink-ab.github.io/tink-link-ios/Scope"><span class="type">Scope</span></a>], <span class="variable">completion</span>: <span class="attribute">@</span><span class="attribute">escaping</span> (<span class="type">Result</span>&lt;[<a href="https://tink-ab.github.io/tink-link-ios/ScopeDescription"><span class="type">ScopeDescription</span></a>], <span class="type">Swift</span>.<span class="type">Error</span>&gt;) -&gt; <span class="type">Void</span>) -&gt; <a href="https://tink-ab.github.io/tink-link-ios/RetryCancellable"><span class="type">RetryCancellable</span></a>?</code></pre></body></html>
<div class="summary" role="doc-abstract">
    <p>Lists scope descriptions for the provided scopes.</p>

</div>
<div class="discussion">
    <p>If aggregating under Tink's license the user must be informed and fully understand what kind of data will be aggregated before aggregating any data.</p>

<h2>Showing Scope Descriptions</h2>

<p>Here's how you can list the scope descriptions for requesing access to accounts and transactions.</p>

<html><body><pre class="highlight"><code><span class="keyword">class</span> <span class="type">ScopeDescriptionCell</span>: <span class="type">UITableViewCell</span> {
    <span class="attribute">override</span> <span class="keyword">init</span>(<span class="variable">style</span>: <span class="type">UITableViewCell</span>.<span class="type">CellStyle</span>, <span class="variable">reuseIdentifier</span>: <span class="type">String</span>?) {
        <span class="keyword">super</span>.<span class="type">init</span>(<span class="variable">style</span>: .<span class="variable">subtitle</span>, <span class="variable">reuseIdentifier</span>: <span class="type">reuseIdentifier</span>)
        <span class="variable">textLabel</span>?.<span class="type">numberOfLines</span> = <span class="number literal">0</span>
        <span class="variable">detailTextLabel</span>?.<span class="type">numberOfLines</span> = <span class="number literal">0</span>
    }

    <span class="attribute">required</span> <span class="keyword">init</span>?(<span class="variable">coder</span>: <span class="type">NSCoder</span>) {
        <span class="variable">fatalError</span>(<span class="string literal">"</span><span class="string literal">init(coder:) has not been implemented</span><span class="string literal">"</span>)
    }
}

<span class="keyword">class</span> <span class="type">ScopeDescriptionsViewController</span>: <span class="type">UITableViewController</span> {
    <span class="keyword">private</span> <span class="keyword">let</span> <span class="variable">authorizationContext</span>: <a href="https://tink-ab.github.io/tink-link-ios/AuthorizationContext"><span class="type">AuthorizationContext</span></a>

    <span class="keyword">private</span> <span class="keyword">var</span> <span class="variable">scopeDescriptions</span>: [<a href="https://tink-ab.github.io/tink-link-ios/ScopeDescription"><span class="type">ScopeDescription</span></a>] = []

    <span class="keyword">init</span>(<span class="variable">user</span>: <span class="type">User</span>) {
        <span class="keyword">self</span>.<span class="type">authorizationContext</span> = <span class="variable">AuthorizationContext</span>(<span class="variable">user</span>: <span class="type">user</span>)
        <span class="keyword">super</span>.<span class="type">init</span>(<span class="variable">nibName</span>: <span class="keyword">nil</span>, <span class="variable">bundle</span>: <span class="keyword">nil</span>)
    }

    <span class="attribute">required</span> <span class="keyword">init</span>?(<span class="variable">coder</span> <span class="variable">aDecoder</span>: <span class="type">NSCoder</span>) {
        <span class="variable">fatalError</span>(<span class="string literal">"</span><span class="string literal">init(coder:) has not been implemented</span><span class="string literal">"</span>)
    }

    <span class="attribute">override</span> <span class="keyword">func</span> <span class="function">viewDidLoad</span>() {
        <span class="keyword">super</span>.<span class="type">viewDidLoad</span>()

        <span class="variable">tableView</span>.<span class="type">register</span>(<span class="variable">ScopeDescriptionCell</span>.<span class="keyword">self</span>, <span class="variable">forCellReuseIdentifier</span>: <span class="string literal">"</span><span class="string literal">Cell</span><span class="string literal">"</span>)

        <span class="keyword">let</span> <span class="variable">scopes</span> [<a href="https://tink-ab.github.io/tink-link-ios/Scope"><span class="type">Scope</span></a>] = [
            .<span class="variable">accounts</span>(.<span class="variable">read</span>),
            .<span class="variable">transactions</span>(.<span class="variable">read</span>)
        ]

        <span class="variable">authorizationContext</span>.<span class="type">fetchScopeDescriptions</span>(<span class="variable">scopes</span>: <span class="type">scopes</span>) { [<span class="variable">weak</span> <span class="keyword">self</span>] <span class="variable">result</span> <span class="keyword">in</span>
            <span class="variable">DispatchQueue</span>.<span class="type">main</span>.<span class="type">async</span> {
                <span class="keyword">do</span> {
                    <span class="keyword">self</span>?.<span class="type">scopeDescriptions</span> = <span class="keyword">try</span> <span class="variable">result</span>.<span class="type">get</span>()
                    <span class="keyword">self</span>?.<span class="type">tableView</span>.<span class="type">reloadData</span>()
                } <span class="keyword">catch</span> {
                    <span class="placeholder">&lt;#Error Handling#&gt;</span>
                }
            }
        }
    }

    <span class="attribute">override</span> <span class="keyword">func</span> <span class="function">tableView</span>(<span class="keyword">_</span> <span class="variable">tableView</span>: <span class="type">UITableView</span>, <span class="variable">numberOfRowsInSection</span> <span class="variable">section</span>: <span class="type">Int</span>) -&gt; <span class="type">Int</span> {
        <span class="keyword">return</span> <span class="variable">scopeDescriptions</span>.<span class="type">count</span>
    }

    <span class="attribute">override</span> <span class="keyword">func</span> <span class="function">tableView</span>(<span class="keyword">_</span> <span class="variable">tableView</span>: <span class="type">UITableView</span>, <span class="variable">cellForRowAt</span> <span class="variable">indexPath</span>: <span class="type">IndexPath</span>) -&gt; <span class="type">UITableViewCell</span> {
        <span class="keyword">let</span> <span class="variable">cell</span> = <span class="variable">tableView</span>.<span class="type">dequeueReusableCell</span>(<span class="variable">withIdentifier</span>: <span class="string literal">"</span><span class="string literal">Cell</span><span class="string literal">"</span>, <span class="variable">for</span>: <span class="type">indexPath</span>)
        <span class="keyword">let</span> <span class="variable">scopeDescription</span> = <span class="variable">scopeDescriptions</span>[<span class="variable">indexPath</span>.<span class="type">row</span>]
        <span class="variable">cell</span>.<span class="type">textLabel</span>?.<span class="type">text</span> = <span class="variable">scopeDescription</span>.<span class="type">title</span>
        <span class="variable">cell</span>.<span class="type">detailTextLabel</span>?.<span class="type">text</span> = <span class="variable">scopeDescription</span>.<span class="type">description</span>
        <span class="keyword">return</span> <span class="variable">cell</span>
    }
}
</code></pre></body></html>
</div>
<h4>Parameters</h4>

<table class="parameters">
  <thead hidden>
  <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
  </tr>
  </thead>
  <tbody>
    <tr>
    <th>scope</th>
    <td></td>
    <td><p>A <code>Tink.Scope</code> list of OAuth scopes to be requested. The Scope array should never be empty.</p>
</td>
</tr>
<tr>
    <th>completion</th>
    <td><code class="type">@escaping (Result&lt;[Scope​Description], Swift.​Error&gt;) -&gt; Void</code></td>
    <td><p>The block to execute when the scope descriptions are received or if an error occurred.</p>
</td>
</tr>
  </tbody>
</table>
  <h4>Returns</h4>
  <p>A Cancellable instance. Call cancel() on this instance if you no longer need the result of the request.</p>

</div>
<div role="article" class="function" id="consentcontext.termsandconditions(for:)">
    <h3>
        <code>terms​And​Conditions(for:​)</code>
    </h3>
    <html><body><pre class="highlight"><code><span class="keyword">public</span> <span class="keyword">func</span> <span class="function">termsAndConditions</span>(<span class="variable">for</span> <span class="variable">locale</span>: <span class="type">Locale</span> = .<span class="variable">current</span>) -&gt; <span class="type">URL</span></code></pre></body></html>
<div class="summary" role="doc-abstract">
    <p>Get a link to the Terms &amp; Conditions for TinkLink.</p>

</div>
<div class="discussion">
    <h2>Showing Terms and Conditions</h2>

<p>If aggregating under Tink's license the user must be presented with an option to view Tink’s Terms and Conditions and Privacy Policy before aggregating any data.</p>

<p>Here's how you can get the url for the Terms and Conditions and present it with the <code>SFSafariViewController</code>.</p>

<html><body><pre class="highlight"><code><span class="keyword">func</span> <span class="function">showTermsAndConditions</span>() {
    <span class="keyword">let</span> <span class="variable">url</span> = <span class="variable">consentContext</span>.<span class="type">termsAndConditions</span>(<span class="variable">locale</span>: <span class="placeholder">&lt;#appLocale#&gt;</span>)
    <span class="keyword">let</span> <span class="variable">safariViewController</span> = <span class="variable">SFSafariViewController</span>(<span class="variable">url</span>: <span class="type">url</span>)
    <span class="variable">present</span>(<span class="variable">safariViewController</span>, <span class="variable">animated</span>: <span class="keyword">true</span>)
}
</code></pre></body></html>
<aside class="note">
    <p>Not all languages are supported. The link will display the page in English if the requested language is not available.</p>

</aside>
</div>
<h4>Parameters</h4>

<table class="parameters">
  <thead hidden>
  <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
  </tr>
  </thead>
  <tbody>
    <tr>
    <th>locale</th>
    <td><code class="type">Locale</code></td>
    <td><p>The locale with the language to use.</p>
</td>
</tr>
  </tbody>
</table>
  <h4>Returns</h4>
  <p>A URL to the Terms &amp; Conditions.</p>

</div>
<div role="article" class="function" id="consentcontext.privacypolicy(for:)">
    <h3>
        <code>privacy​Policy(for:​)</code>
    </h3>
    <html><body><pre class="highlight"><code><span class="keyword">public</span> <span class="keyword">func</span> <span class="function">privacyPolicy</span>(<span class="variable">for</span> <span class="variable">locale</span>: <span class="type">Locale</span> = .<span class="variable">current</span>) -&gt; <span class="type">URL</span></code></pre></body></html>
<div class="summary" role="doc-abstract">
    <p>Get a link to the Privacy Policy for TinkLink.</p>

</div>
<div class="discussion">
    <h2>Showing Privacy Policy</h2>

<p>If aggregating under Tink's license the user must be presented with an option to view Tink’s Terms and Conditions and Privacy Policy before aggregating any data.</p>

<p>Here's how you can get the url for the Privacy Policy and present it with the <code>SFSafariViewController</code>.</p>

<html><body><pre class="highlight"><code><span class="keyword">func</span> <span class="function">showPrivacyPolicy</span>() {
    <span class="keyword">let</span> <span class="variable">url</span> = <span class="variable">consentContext</span>.<span class="type">privacyPolicy</span>(<span class="variable">locale</span>: <span class="placeholder">&lt;#appLocale#&gt;</span>)
    <span class="keyword">let</span> <span class="variable">safariViewController</span> = <span class="variable">SFSafariViewController</span>(<span class="variable">url</span>: <span class="type">url</span>)
    <span class="variable">present</span>(<span class="variable">safariViewController</span>, <span class="variable">animated</span>: <span class="keyword">true</span>)
}
</code></pre></body></html>
<aside class="note">
    <p>Not all languages are supported. The link will display the page in English if the requested language is not available.</p>

</aside>
</div>
<h4>Parameters</h4>

<table class="parameters">
  <thead hidden>
  <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
  </tr>
  </thead>
  <tbody>
    <tr>
    <th>locale</th>
    <td><code class="type">Locale</code></td>
    <td><p>The locale with the language to use.</p>
</td>
</tr>
  </tbody>
</table>
  <h4>Returns</h4>
  <p>A URL to the Privacy Policy.</p>

</div>
    </section>



        </article>
    </main>

    <footer>
        <p>
    Generated on <time datetime="2020-08-20T12:06:50+0200">20 August 2020</time> using <a href="https://github.com/SwiftDocOrg/swift-doc">swift-doc</a> <span class="version">1.0.0-beta.3</span>.
</p>
    </footer>
</body>
</html>
